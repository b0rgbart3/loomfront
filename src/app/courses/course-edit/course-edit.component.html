

<div class='stuff'>
   
        <form [formGroup]="courseForm" novalidate (ngSubmit)="postCourse()">
        
            <div class='loomCard'>
                    <div class="padMe">
                <h1>Course Info:</h1>
                <flash-messages></flash-messages>

                <md-form-field [ngClass]="{'has-error':(courseForm.get('title').touched || courseForm.get('title').dirty)}">
                <input id="title" mdInput placeholder="Title" formControlName="title" >
                </md-form-field>
                <md-form-field>

                <!-- <span class="help-block" *ngIf="(courseForm.get('title').touched || courseForm.get('title').dirty)}">
                        <span *ngIf="courseForm.get('title').errors.required">
                            Please enter a title for this course.
                        </span>
                        <span *ngIf="courseForm.get('description').errors.minlength">
                            The Title must be longer than 3 characters.
                        </span>
                    </span> -->
            
                <input id="description" mdInput placeholder="Description" formControlName="description" >
                </md-form-field>
               <br>
                <br><img [src]="imageUrl" width='200' height='200' *ngIf='image'><br>
                


                <div class="upload-wrap">
                   Upload Image
                   <input type="file" class="upload-btn"  name="imageUploader"  
                   ng2FileSelect [uploader]="uploader" formControlName="imageUploader"
                   (change)="fileChange($event)" id="imageUploader">
               </div>


                <br>
                <div formArrayName='sections' *ngFor="let section of sections.controls; let i=index">
                    <div [formGroupName]="i" class='sectionContainer'>
                        <button class='loomKill rightAlignMe' (click)="killSection(i)"></button>
                            
                      
                        <div class='bannerTop'>
                            <md-form-field>
                            <input mdInput id="{{ 'title' + i }}" 
                            placeholder="Title of Section {{ i+1 }} " formControlName="title">
                            </md-form-field>
                        </div>
                        <div class='sectionSection'>
                            <md-form-field>
                            <textarea mdInput id="content" placeholder="Section Content"
                                 formControlName="content"></textarea>
                            </md-form-field>

                            <div *ngIf='section.controls.materials' >
                            <div formArrayName='materials' *ngFor='let material of section.controls.materials.controls; let j=index'>
                                <div [formGroupName]="j"> 
                                    <!-- <md-form-field>
                                    <input mdInput id="{{ 'material' +j }}" formControlName="reference">
                                     </md-form-field> -->
                                     
                                    <md-select placeholder='Material' formControlName='reference'>
                                            <md-option *ngFor='let item of materialList' mdOption [value]='item.id' ng-selected="reference"> {{ item.title }}</md-option>
                                        </md-select>
                                   
                                </div>
                            </div>
                            </div><button md-raised-button (click)="addMaterial(i)" type='button'>Add Material</button>
                        </div>
                        
                        
                        
                    </div>
                </div>
                <br>
                <button md-raised-button (click)="addSection()" type='button'>Add Section</button>
            </div><button md-raised-button color="primary" class='loomButton' 
                type='submit' [disabled]="!courseForm.valid" >Submit changes</button>
            
        </div>
 
        </form><br>       <button (click)="showForm()">ShowFormInfo</button>
</div>

<div class='debug'>
   Form Dirty: {{ courseForm.dirty }}<br>
   Form Touched: {{ courseForm.touched }}<br>
   Form valid: {{ courseForm.valid }}<br>
   Title: {{ courseForm.controls.title }}<br>
   Title Valid: {{ courseForm.controls.title.valid }}<br>
   Entire Form Value: {{ courseForm.value | json }}<br> 
</div>