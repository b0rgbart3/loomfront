

    <div class="loomContainer group">
        <div class='settingsForm' *ngIf="settingsForm">
        <form [formGroup]="settingsForm" novalidate
         enctype="multipart/form-data" class='loomForm'>
        
            <div class="loomCard"> 
                                
            <flash-messages></flash-messages>
            <div class='closer'
            (click)="cancel()"></div>

            <h1>{{ user.username }}'s Settings:</h1>
            <mat-form-field>
                <input matInput placeholder="Username" 
                formControlName="username" value="{{user.username}}">
                </mat-form-field><br clear='all'>
            <mat-form-field>
                <input matInput placeholder="First name" 
                formControlName="firstname" value="{{user.firstname}}">
                </mat-form-field><br clear='all'>
            <mat-form-field>
                    <input matInput placeholder="Last name" 
                    formControlName="lastname" value="{{user.lastname}}">
                    </mat-form-field><br clear='all'>
            <mat-form-field>
                    <input matInput placeholder="Email address" 
                    formControlName="email" value="{{user.email}}">
                    </mat-form-field><br clear='all'>
           <mat-form-field>
            <textarea id="bio" matInput placeholder="Super Short Bio" 
            formControlName="bio" rows="4" class='bioArea'>{{ user.bio}}</textarea>
            <div class='hint' *ngIf='!settingsForm.get("bio").valid'>The bio needs to be 400 characters or less. It is currently {{ biolength }} characters.</div>
            <div class='explanation' *ngIf='!settingsForm.get("bio").valid'>The bio is too long</div>
            </mat-form-field><br clear='all'>
<br>
            <div class="form-group">

                     <h2>Your Avatar Image:</h2>

                   <!-- <br><img [src]="user.avatar_URL" width='200' height='200' *ngIf="user && user.avatar_URL"><br>
                   <br><img [src]="localImageUrl" *ngIf="localImageUrl" class='cropTarget'><br> -->
                   <img [src]="localImageUrl" class="avatar">
                   
                     <div class="upload-wrap" *ngIf="!user.facebookRegistration">
                        Upload New Avatar Image

         
                        <input type="file" class="upload-btn"  name="avatar"  
                        ng2FileSelect [uploader]="avatarUploader" formControlName="avatar"
                        (change)="avatarChange($event)" id="avatar">
                    </div>
                        
            </div> 
    

                
            </div>


       <br>
            <div class='loomButton loomSubmit' 
            (click)='submitSettings()'>Submit changes</div>
           
        <br clear='all'><br>

        </form>
        
    </div>
    
 
</div>

<div class='debug'>
        Form Dirty: {{ settingsForm.dirty }}<br>
        Form Touched: {{ settingsForm.touched }}<br>
        Form valid: {{ settingsForm.valid }}<br>

     </div>